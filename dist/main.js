(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();class T{constructor(){this.formspreeEndpoint="https://formspree.io/f/YOUR_FORM_ID",this.backupMethods=[]}async submitParticipantData(e){console.log("Starting data submission with hybrid approach...");const t=[];try{await this.submitToFormspree(e)?t.push("✅ Online submission successful"):t.push("❌ Online submission failed")}catch(s){console.error("Formspree submission error:",s),t.push("❌ Online submission error")}try{this.downloadAsJSON(e),t.push("✅ JSON file downloaded")}catch(s){console.error("Download failed:",s),t.push("❌ Download failed")}try{this.saveToLocalStorage(e),t.push("✅ Browser backup saved")}catch(s){console.error("LocalStorage failed:",s),t.push("❌ Browser backup failed")}return t}async submitToFormspree(e){if(this.formspreeEndpoint.includes("YOUR_FORM_ID"))return console.log("Formspree not configured, skipping online submission"),!1;try{return(await fetch(this.formspreeEndpoint,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({sessionId:e.sessionId,participantData:JSON.stringify(e,null,2),timestamp:new Date().toISOString(),studyType:"8_chart_hhlc_experiment"})})).ok}catch(t){return console.error("Formspree submission failed:",t),!1}}downloadAsJSON(e){var i,d,h,g,u,m,f,y,S,b,w,C,O,I;const t={demographic:{age:((i=e.demographic)==null?void 0:i.age)||"",education:((d=e.demographic)==null?void 0:d.education)||"",profession:((h=e.demographic)==null?void 0:h.profession)||"",visualization:((g=e.demographic)==null?void 0:g.visualization)||"",visualizationBackground:((u=e.demographic)==null?void 0:u.visualizationBackground)||"",visualImpairment:((m=e.demographic)==null?void 0:m.visualImpairment)||"",chartFamiliarity:{barCharts:((y=(f=e.demographic)==null?void 0:f.chartFamiliarity)==null?void 0:y.barCharts)||"",lineCharts:((b=(S=e.demographic)==null?void 0:S.chartFamiliarity)==null?void 0:b.lineCharts)||"",scatterplots:((C=(w=e.demographic)==null?void 0:w.chartFamiliarity)==null?void 0:C.scatterplots)||"",geographicalMaps:((I=(O=e.demographic)==null?void 0:O.chartFamiliarity)==null?void 0:I.geographicalMaps)||""}},responses:e.responses||[],sessionId:e.sessionId,selectedCharts:e.selectedCharts||[],chartCategories:e.chartCategories||{},completedAt:new Date().toISOString(),totalTimeMinutes:e.totalTimeMinutes||0},s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),o=URL.createObjectURL(s),r=document.createElement("a");r.href=o,r.download=`participant_${e.sessionId}.json`,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o),console.log(`Downloaded: participant_${e.sessionId}.json`)}saveToLocalStorage(e){const t=`hhlc_participant_${e.sessionId}`;localStorage.setItem(t,JSON.stringify(e)),localStorage.setItem("hhlc_latest_session",e.sessionId),console.log(`Saved to localStorage: ${t}`)}getFromLocalStorage(e){const t=`hhlc_participant_${e}`,s=localStorage.getItem(t);return s?JSON.parse(s):null}getAllStoredSessions(){const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s&&s.startsWith("hhlc_participant_")){const o=s.replace("hhlc_participant_","");e.push(o)}}return e}setFormspreeEndpoint(e){this.formspreeEndpoint=e}showCompletionMessage(e,t){e.filter(o=>o.startsWith("✅")).length,e.length;const s=`
            <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                <h2 style="color: #28a745;">✅ Thank You for Participating!</h2>
                <p style="font-size: 18px; margin: 20px 0;">Your data has been saved successfully!</p>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h3 style="margin-top: 0;">Data Submission Status:</h3>
                    <ul style="text-align: left; display: inline-block;">
                        ${e.map(o=>`<li style="margin: 5px 0;">${o}</li>`).join("")}
                    </ul>
                </div>
                
                <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                    <p><strong>Study ID:</strong> <code>${t}</code></p>
                    <p style="font-size: 14px; color: #666;">
                        Please save this ID for your records. If you downloaded a file, 
                        please keep it safe as a backup of your participation.
                    </p>
                </div>
                
                <p style="color: #666; font-size: 14px;">
                    Questions about this study? Contact: researcher@email.com
                </p>
            </div>
        `;document.body.innerHTML=s}}const c=new T,n=8,_=40,L=n*3;let v=0;const D=[{name:"Single-class Scatterplots",range:[1,5]},{name:"Multi-class Scatterplots",range:[6,10]},{name:"Single-class Line Charts",range:[11,15]},{name:"Multi-class Line Charts",range:[16,20]},{name:"Single-class Bar Graphs",range:[21,25]},{name:"Multi-class Bar Graphs",range:[26,30]},{name:"Single-class Maps",range:[31,35]},{name:"Multi-class Maps",range:[36,40]}];JSON.parse(localStorage.getItem("participantData"));function M(){const a=[];D.forEach(e=>{const[t,s]=e.range,o=[];for(let r=t;r<=s;r++)o.push(r);for(let r=o.length-1;r>0;r--){const i=Math.floor(Math.random()*(r+1));[o[r],o[i]]=[o[i],o[r]]}a.push(...o.slice(0,1))});for(let e=a.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[a[e],a[t]]=[a[t],a[e]]}if(a.length>n)return a.slice(0,n);if(a.length<n){const e=[];for(let s=1;s<=_;s++)e.push(s);const t=e.filter(s=>!a.includes(s));for(;a.length<n&&t.length;){const s=Math.floor(Math.random()*t.length);a.push(t.splice(s,1)[0])}}return a}const l=M();function p(a){for(const e of D){const[t,s]=e.range;if(a>=t&&a<=s)return e.name}return"Unknown"}async function A(){console.log("Submitting data using hybrid approach...");const a=JSON.parse(localStorage.getItem("participantData"))||{},e={demographic:a.demographic||{},responses:a.responses||[],sessionId:a.sessionId||`session_${Date.now()}`,selectedCharts:l,chartCategories:{},completedAt:new Date().toISOString(),totalTimeMinutes:Math.round(v/6e4)||0};l.forEach((t,s)=>{e.chartCategories[t.toString()]=p(t)});try{const t=await c.submitParticipantData(e);c.showCompletionMessage(t,e.sessionId),console.log("Data submission completed:",t)}catch(t){console.error("Data submission failed:",t),c.downloadAsJSON(e),c.showCompletionMessage(["✅ Downloaded backup file"],e.sessionId)}}window.submitDataHybrid=A;window.getStratifiedCharts=M;window.getChartCategory=p;window.TOTAL_CHARTS=n;window.TOTAL_STEPS=L;window.selectedCharts=l;document.addEventListener("DOMContentLoaded",()=>{if(console.log("HHLC Experiment initialized with Vite"),console.log("Selected charts for this session:",l),console.log("Chart categories:",l.map(a=>({id:a,category:p(a)}))),!localStorage.getItem("participantData")){const a=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;localStorage.setItem("participantData",JSON.stringify({sessionId:a,demographic:{},responses:[]}))}});
//# sourceMappingURL=main.js.map
