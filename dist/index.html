<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hierarchical Higher-Level Constructs Study</title>
    <link rel="stylesheet" href="styles.css">
  <script type="module" crossorigin src="/HHLC-user-study/main.js"></script>
  <link rel="stylesheet" crossorigin href="/HHLC-user-study/assets/main.css">
</head>
<body>
  <div class="container">


    <div class="start-container">
      <h1 style="margin-bottom: 20px;">HHLC User Study</h1>

      <div style="background-color: #f0f8ff; border: 1px solid #4a90e2; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                <p style="margin: 0; color: #2c5282;">
            ðŸ“¹ Please note: Your whole screen will be recorded during this study session.
        </p>
      </div>

      <p style="margin-bottom: 15px; line-height: 1.6;">
        The purpose of our study is to investigate how individuals with diverse individual differences interpret various types of data visualizations, including line charts, bar charts, scatterplots, and geographic maps. By presenting randomized stimuli across these visualization types and collecting open-ended responses, we aim to understand how people extract meaning, recognize patterns, and reason about data.
      </p>

      <p style="margin-bottom: 15px; line-height: 1.6;">
        Being in a research study is completely voluntary. You can choose not to be in this research study. You can also say yes now and change your mind later. Note that if you end the study before completing it, your data will not be recorded.
      </p>

      <p style="margin-bottom: 15px; line-height: 1.6;">
        Study Details: If you agree to take part in this research, you will be shown a series of visualizations like graphs and charts and asked questions about your interpretation and understanding. Your participation in this study will take approximately 45-60 minutes. You must be at least 18 years old to participate.
      </p>

      <p style="margin-bottom: 15px; line-height: 1.6;">
       The possible risks to you in taking part in this research are minimal and relate primarily to confidentiality. The possible benefits include contributing to research that will help design more accessible and effective visual representations for diverse audiences.
      </p>

      <p style="margin-bottom: 20px; line-height: 1.6;">
        If you have any questions about this research, please contact Tapendra Pandey by emailing pandey@ou.edu, Matthew Tran by emailing matthew.tran-1@ou.edu, or Ghulam Quadri by emailing quadri@ou.edu. If you have questions or concerns about your rights as a research subject, you may contact the OU Norman Campus Institutional Review Board at 405-325-8110 or by email to irb@ou.edu.
      </p>

      <br>
      <!-- <label>
        <input type="checkbox" id="consent">
        I agree and consent to participate in this study.
      </label> -->
      <br>
      <button class="start-btn" onclick="startNewSession()">Agree and Continue</button>
      </div>
    </div>

  <script>
    function startNewSession() {
      console.log('startNewSession function called');
      
      // Simplified session initialization for Vite deployment (no server needed)
      try {
        const sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        const participantId = `participant_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        
        // Store session data in localStorage
        const sessionData = {
          sessionId: sessionId,
          participantId: participantId,
          demographic: {},
          responses: [],
          startTime: new Date().toISOString()
        };
        
        localStorage.setItem("participantData", JSON.stringify(sessionData));
        
        console.log(`New session started for participant: ${participantId}`);
        console.log('Session data stored:', sessionData);
        console.log('Current location:', window.location.href);
        console.log('Attempting navigation to demographicSurvey.html');
        
  // Navigate using explicit path construction
  // Normalize pathname: remove any trailing slash and strip '/index.html' if present
  let pathname = window.location.pathname || '';
  pathname = pathname.replace(/\/index\.html$/i, '');
  pathname = pathname.replace(/\/$/, '');
  const baseUrl = window.location.origin + (pathname === '' ? '' : pathname);
  const targetUrl = baseUrl + '/demographicSurvey.html';
  console.log('Normalized pathname:', pathname);
  console.log('Target URL:', targetUrl);
  window.location.href = targetUrl;
        
      } catch (error) {
        console.error('Session initialization failed:', error);
        alert('Failed to initialize session. Please try again.');
      }
    }
  </script> 
</body>
</html>
